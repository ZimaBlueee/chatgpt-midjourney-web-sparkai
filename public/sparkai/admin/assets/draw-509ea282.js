
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
  
import{_ as le}from"./index-c786b651.js";import{a8 as y,d as ae,r as m,Q as oe,t as ne,o as _,c as k,e as t,f as l,R as P,S as j,b as D,k as c,a as b,w as re,I as S,x as f,E as N,h as o,X as se,q as O}from"./index-56458f60.js";import{A as B}from"./chat-e9cc9d7d.js";import{u as ie}from"./utcformatTime-e76e5157.js";import{e as ue,W as ce,f as de}from"./index-70c9cd4a.js";const pe={queryAdminDrawList:s=>y.get("midjourney/adminDrawList",{params:s}),salesAuditOrder:s=>y.post("sales/auditOrder",s),updateSalesUser:s=>y.post("sales/updateUserSales",s),queryRecords:s=>y.get("sales/inviteRecords",{params:s}),querySalesUserList:s=>y.get("sales/salesUserList",{params:s})},_e={style:{float:"right"}},fe=["onClick"],me={class:"answer"},ge={class:"answer_container"},we=["src"],ve=ae({__name:"draw",setup(s){const V=m(),R=m(0),I=m(!1),i=oe({rec:null,status:null,page:1,size:10}),x=m([]);async function d(){try{I.value=!0;const n=await pe.queryAdminDrawList(i);I.value=!1;const{rows:a,count:C}=n.data;R.value=C,x.value=a}catch{I.value=!1}}function W(n){n==null||n.resetFields(),d()}async function Y(n){const a=await B.recMjDrawImg({id:n});N.success(a.data),d()}async function F(n){const a=await B.delChatLog({id:n});N.success(a.data),d()}const A=m(!1),M=m("");async function E(n){M.value=n,A.value=!0}return ne(()=>{d()}),(n,a)=>{const C=o("el-option"),T=o("el-select"),z=o("el-form-item"),g=o("el-button"),H=o("el-form"),U=le,J=o("el-alert"),r=o("el-table-column"),Q=o("el-image"),L=o("el-tag"),X=o("el-popover"),$=o("el-popconfirm"),G=o("el-table"),K=o("el-pagination"),Z=o("el-row"),ee=o("el-dialog"),te=se("loading");return _(),k("div",null,[t(U,null,{default:l(()=>[t(H,{ref_key:"formRef",ref:V,inline:!0,model:i},{default:l(()=>[t(z,{label:"推荐状态",prop:"rec"},{default:l(()=>[t(T,{modelValue:i.rec,"onUpdate:modelValue":a[0]||(a[0]=e=>i.rec=e),placeholder:"请选择推荐状态",clearable:""},{default:l(()=>[(_(!0),k(P,null,j(D(ue),e=>(_(),S(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(z,{label:"绘制状态",prop:"status"},{default:l(()=>[t(T,{modelValue:i.status,"onUpdate:modelValue":a[1]||(a[1]=e=>i.status=e),placeholder:"请选择绘制状态",clearable:""},{default:l(()=>[(_(!0),k(P,null,j(D(ce),e=>(_(),S(C,{key:e.value,label:e.label,value:e.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(z,null,{default:l(()=>[t(g,{type:"primary",onClick:d},{default:l(()=>[c(" 查询 ")]),_:1}),t(g,{onClick:a[2]||(a[2]=e=>W(V.value))},{default:l(()=>[c(" 重置 ")]),_:1})]),_:1}),b("span",_e,[t(g,{type:"success",onClick:d},{default:l(()=>[c(" 刷新列表 ")]),_:1})])]),_:1},8,["model"])]),_:1}),t(U,null,{default:l(()=>[t(J,{"show-icon":"",title:"MJ绘图历史说明",description:"点击推荐的图片将会出现在画廊当中！",type:"success"})]),_:1}),t(U,{style:{width:"100%"}},{default:l(()=>[re((_(),S(G,{border:"",data:x.value,style:{width:"100%"},size:"large"},{default:l(()=>[t(r,{prop:"id",align:"center",label:"ID",width:"70"}),t(r,{prop:"fileInfo.thumbImg",align:"center",label:"绘图结果"},{default:l(e=>{var u,p,w,v,h;return[(u=e.row)!=null&&u.failReason?(_(),k("div",{key:0,style:{cursor:"pointer",color:"red"},onClick:he=>{var q;return E((q=e.row)==null?void 0:q.failReason)}},"点击查看原因",8,fe)):(_(),S(Q,{key:1,style:{height:"120px"},"preview-teleported":"",fit:"contain","preview-src-list":[(w=(p=e.row)==null?void 0:p.fileInfo)==null?void 0:w.cosUrl],src:(h=(v=e.row)==null?void 0:v.fileInfo)==null?void 0:h.thumbImg,lazy:"","hide-on-click-modal":""},null,8,["preview-src-list","src"]))]}),_:1}),t(r,{prop:"userInfo.username",align:"center",label:"用户名",width:"120"}),t(r,{prop:"fileInfo.thumbImg",align:"center",label:"推荐状态",width:"90"},{default:l(e=>[t(L,{type:e.row.rec===1?"success":""},{default:l(()=>[c(f(e.row.rec===1?"已推荐":"未推荐"),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"userInfo.email",label:"邮箱",width:"180",align:"center"}),t(r,{prop:"status",align:"center",label:"绘图状态",width:"105"},{default:l(e=>[t(L,{type:e.row.status===100?"success":""},{default:l(()=>[c(f(D(de)[e.row.status]),1)]),_:2},1032,["type"])]),_:1}),t(r,{prop:"fullPrompt",label:"绘图指令",align:"center",width:"200"},{default:l(e=>[t(X,{placement:"top",width:400,trigger:"click"},{reference:l(()=>[b("div",me,f(e.row.fullPrompt),1)]),default:l(()=>[b("div",ge,f(e.row.fullPrompt),1)]),_:2},1024)]),_:1}),t(r,{prop:"progress",align:"center",label:"绘图进度",width:"90"}),t(r,{prop:"fileInfo.thumbImg",align:"center",label:"绘图尺寸",width:"120"},{default:l(e=>{var u,p,w,v,h;return[c(f((u=e.row)!=null&&u.fileInfo?`${(w=(p=e.row)==null?void 0:p.fileInfo)==null?void 0:w.width}*${(h=(v=e.row)==null?void 0:v.fileInfo)==null?void 0:h.height}`:"---"),1)]}),_:1}),t(r,{prop:"userInfo.avatar",label:"用户头像",width:"90"},{default:l(e=>{var u,p;return[b("img",{src:(p=(u=e.row)==null?void 0:u.userInfo)==null?void 0:p.avatar,style:{height:"50px"}},null,8,we)]}),_:1}),t(r,{prop:"createdAt",label:"提问时间",align:"center",width:"200"},{default:l(e=>[c(f(D(ie)(e.row.createdAt,"YYYY-MM-DD hh:mm:ss")),1)]),_:1}),t(r,{fixed:"right",label:"操作",width:"200",align:"center"},{default:l(e=>[t($,{title:`确认${e.row.rec===1?"取消推荐":"推荐"}图片吗！`,width:"260","icon-color":"red",onConfirm:u=>Y(e.row.id)},{reference:l(()=>[t(g,{link:"",type:e.row.rec===1?"success":"",size:"small"},{default:l(()=>[c(" 推荐图片 ")]),_:2},1032,["type"])]),_:2},1032,["title","onConfirm"]),t($,{title:"`确认删除此条记录么！",width:"260","icon-color":"red",onConfirm:u=>F(e.row.id)},{reference:l(()=>[t(g,{type:"warning",size:"small"},{default:l(()=>[c(" 删除记录 ")]),_:1})]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data"])),[[te,I.value]]),t(Z,{class:"flex justify-end mt-5"},{default:l(()=>[t(K,{"current-page":i.page,"onUpdate:currentPage":a[3]||(a[3]=e=>i.page=e),"page-size":i.size,"onUpdate:pageSize":a[4]||(a[4]=e=>i.size=e),class:"mr-5","page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:R.value,onSizeChange:d,onCurrentChange:d},null,8,["current-page","page-size","total"])]),_:1})]),_:1}),t(ee,{modelValue:A.value,"onUpdate:modelValue":a[5]||(a[5]=e=>A.value=e),title:"绘画失败原因",width:"30%",center:""},{default:l(()=>[b("span",null,f(M.value),1)]),_:1},8,["modelValue"])])}}});typeof O=="function"&&O(ve);export{ve as default};
